<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đặt vé xem phim</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">

    <style>
        /* Custom styles */
        body {
        transition: background-color 0.3s, color 0.3s;
        }

        .dark-mode {
        background-color: #121212;
        color: #fff;
        }

        .dark-mode .card {
        background-color: #333;
        color: #fff;
        }

        .dark-mode .section {
        background-color: #222;
        box-shadow: 0 0 10px rgba(255,255,255,0.1);
        }

        .dark-mode .btn-outline-primary {
        color: #8bb9fe;
        border-color: #8bb9fe;
        }

        .dark-mode .btn-outline-primary:hover {
        background-color: #0d6efd;
        color: #fff;
        }

        .seat {
        width: 50px;
        height: 50px;
        margin: 5px;
        border: 1px solid #999;
        background-color: #f0f0f0;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
        }

        .seat:hover {
        transform: scale(1.1);
        }

        .seat.selected {
        background-color: #28a745;
        color: white;
        }

        .seat.occupied {
        background-color: #dc3545;
        color: white;
        cursor: not-allowed;
        }

        .row {
        justify-content: center;
        margin-bottom: 10px;
        }

        .screen {
        background-color: #ccc;
        height: 10px;
        width: 80%;
        margin: 0 auto 30px;
        border-radius: 5px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.7);
        }

        .seat-legend {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 20px;
        }

        .legend-item {
        display: flex;
        align-items: center;
        gap: 5px;
        }

        .legend-box {
        width: 20px;
        height: 20px;
        border-radius: 3px;
        }

        .legend-available {
        background-color: #f0f0f0;
        border: 1px solid #999;
        }

        .legend-selected {
        background-color: #28a745;
        }

        .legend-occupied {
        background-color: #dc3545;
        }

        .swiper-container {
        margin: 20px 0;
        padding: 20px 0;
        }

        .card {
        transition: transform 0.3s ease;
        height: 100%;
        }

        .card:hover {
        transform: scale(1.05);
        }

        .card img {
        height: 300px;
        object-fit: cover;
        }

        .movie-info {
        padding: 10px;
        }

        #movie-selection {
        margin-bottom: 20px;
        }

        .section {
        margin-bottom: 40px;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        }

        .carousel-inner img {
        height: 500px;
        object-fit: cover;
        }

        .mode-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        transition: all 0.3s ease;
        }

        .time-btn.active {
        background-color: #0d6efd;
        color: white;
        }

        .badge-new {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: #ff4757;
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-weight: bold;
        z-index: 10;
        }

        .section-heading {
        position: relative;
        display: inline-block;
        padding-bottom: 10px;
        }

        .section-heading::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 25%;
        right: 25%;
        height: 3px;
        background-color: #0d6efd;
        border-radius: 5px;
        }


    </style>
</head>
<body>
    <div class="container-fluid py-3">
        <button id="toggleDarkMode" class="btn btn-dark mode-toggle">
            <i class="fas fa-moon"></i> Chuyển chế độ
        </button>

        <div class="container mt-4">
            <!-- Hero Banner -->
            <div class="section">
                <h2 class="text-center mb-4 section-heading">PHIM HOT</h2>
                <div id="imageSlider" class="carousel slide" data-bs-ride="carousel">
                    <!-- Indicators -->
                    <div class="carousel-indicators">
                        <button type="button" data-bs-target="#imageSlider" data-bs-slide-to="0" class="active"></button>
                        <button type="button" data-bs-target="#imageSlider" data-bs-slide-to="1"></button>
                        <button type="button" data-bs-target="#imageSlider" data-bs-slide-to="2"></button>
                    </div>

                    <!-- Slides -->
                    <div class="carousel-inner rounded">
                        <div class="carousel-item active">
                            <img src="https://via.placeholder.com/1200x500" class="d-block w-100" alt="Phim 1">
                            <div class="carousel-caption d-none d-md-block">
                                <h3>Dune: Part Two</h3>
                                <p>Cuộc chiến giữa các dòng tộc vì quyền kiểm soát nguồn tài nguyên quý giá nhất hệ mặt trời</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="https://via.placeholder.com/1200x500" class="d-block w-100" alt="Phim 2">
                            <div class="carousel-caption d-none d-md-block">
                                <h3>Deadpool & Wolverine</h3>
                                <p>Cuộc phiêu lưu điên rồ của hai siêu anh hùng Marvel</p>
                            </div>
                        </div>
                        <div class="carousel-item">
                            <img src="https://via.placeholder.com/1200x500" class="d-block w-100" alt="Phim 3">
                            <div class="carousel-caption d-none d-md-block">
                                <h3>Inside Out 2</h3>
                                <p>Khám phá sâu hơn về thế giới cảm xúc phức tạp của con người</p>
                            </div>
                        </div>
                    </div>

                    <!-- Controls -->
                    <button class="carousel-control-prev" type="button" data-bs-target="#imageSlider" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#imageSlider" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>

            <!-- Movie Selection -->
            <div class="section" id="movie-selection">
                <h2 class="text-center mb-4 section-heading">PHIM ĐANG CHIẾU</h2>
                <div class="swiper-container movie-swiper">
                    <div class="swiper-wrapper">
                        @foreach (var item in Model)
                        {
                            <div class="swiper-slide">
                                <div class="card">
                                    <span class="badge-new">MỚI</span>
                                    <img src="@item.PosterUrl" class="card-img-top" alt="@item.Title">
                                    <div class="card-body">
                                        <h5 class="card-title">@item.Title</h5>
                                        <p class="card-text"><small><i class="fas fa-clock"></i>  phút</small></p>
                                        <div class="d-flex justify-content-between">
                                            <button class="btn btn-primary select-movie" data-movie-id="@item.Id" data-movie-name="@item.Title">Chọn</button>
                                            <a href="@Url.Action("Details", "Movie", new { id = item.Id })" class="btn btn-outline-primary">Chi tiết</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                </div>
            </div>

            <!-- Seat Selection -->
            <div class="section" id="seat-selection">
                <h2 class="text-center mb-4 section-heading">Chọn ghế</h2>

                <div id="screening-time" class="text-center mb-4">
                    <h5>Chọn suất chiếu:</h5>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-outline-primary time-btn" data-time="10:00">10:00</button>
                        <button type="button" class="btn btn-outline-primary time-btn" data-time="13:30">13:30</button>
                        <button type="button" class="btn btn-outline-primary time-btn" data-time="16:00">16:00</button>
                        <button type="button" class="btn btn-outline-primary time-btn" data-time="19:30">19:30</button>
                        <button type="button" class="btn btn-outline-primary time-btn" data-time="22:00">22:00</button>
                    </div>
                </div>

                <div class="text-center mb-4">
                    <p>Màn hình</p>
                    <div class="screen"></div>
                </div>

                <div class="seat-legend">
                    <div class="legend-item">
                        <div class="legend-box legend-available"></div>
                        <span>Ghế trống</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box legend-selected"></div>
                        <span>Ghế đã chọn</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box legend-occupied"></div>
                        <span>Ghế đã đặt</span>
                    </div>
                </div>

                <div id="seat-container" class="text-center">
                    <div class="row">
                        <button class="seat" data-seat="A1">A1</button>
                        <button class="seat" data-seat="A2">A2</button>
                        <button class="seat occupied" data-seat="A3">A3</button>
                        <button class="seat" data-seat="A4">A4</button>
                        <button class="seat" data-seat="A5">A5</button>
                        <button class="seat occupied" data-seat="A6">A6</button>
                        <button class="seat" data-seat="A7">A7</button>
                        <button class="seat" data-seat="A8">A8</button>
                    </div>
                    <div class="row">
                        <button class="seat" data-seat="B1">B1</button>
                        <button class="seat" data-seat="B2">B2</button>
                        <button class="seat" data-seat="B3">B3</button>
                        <button class="seat occupied" data-seat="B4">B4</button>
                        <button class="seat" data-seat="B5">B5</button>
                        <button class="seat" data-seat="B6">B6</button>
                        <button class="seat" data-seat="B7">B7</button>
                        <button class="seat" data-seat="B8">B8</button>
                    </div>
                    <div class="row">
                        <button class="seat" data-seat="C1">C1</button>
                        <button class="seat occupied" data-seat="C2">C2</button>
                        <button class="seat" data-seat="C3">C3</button>
                        <button class="seat" data-seat="C4">C4</button>
                        <button class="seat" data-seat="C5">C5</button>
                        <button class="seat" data-seat="C6">C6</button>
                        <button class="seat occupied" data-seat="C7">C7</button>
                        <button class="seat" data-seat="C8">C8</button>
                    </div>
                    <div class="row">
                        <button class="seat" data-seat="D1">D1</button>
                        <button class="seat" data-seat="D2">D2</button>
                        <button class="seat" data-seat="D3">D3</button>
                        <button class="seat" data-seat="D4">D4</button>
                        <button class="seat occupied" data-seat="D5">D5</button>
                        <button class="seat" data-seat="D6">D6</button>
                        <button class="seat" data-seat="D7">D7</button>
                        <button class="seat" data-seat="D8">D8</button>
                    </div>
                </div>

                <div class="card mt-4">
                    <div class="card-body">
                        <h5 class="card-title">Thông tin đặt vé</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <p><i class="fas fa-film me-2"></i>Phim: <span id="selectedMovie">Chưa chọn</span></p>
                                <p><i class="fas fa-clock me-2"></i>Suất chiếu: <span id="selectedTime">Chưa chọn</span></p>
                                <p><i class="fas fa-chair me-2"></i>Ghế đã chọn: <span id="selectedSeats">Chưa chọn</span></p>
                            </div>
                            <div class="col-md-6">
                                <p><i class="fas fa-tag me-2"></i>Đơn giá: 50.000 VNĐ/vé</p>
                                <p><i class="fas fa-ticket-alt me-2"></i>Số lượng: <span id="ticketCount">0</span> vé</p>
                                <p><i class="fas fa-money-bill-wave me-2"></i>Tổng tiền: <span id="totalPrice">0</span> VNĐ</p>
                            </div>
                        </div>
                        <div class="progress mt-3">
                            <div id="bookingProgress" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                        </div>
                    </div>
                </div>

                <div class="text-center mt-4">
                    <form id="paymentForm" action="/Payment/Process" method="post">
                        <input type="hidden" id="hiddenSeats" name="selectedSeats" value="">
                        <input type="hidden" id="hiddenAmount" name="amount" value="0">
                        <button id="checkout" class="btn btn-success btn-lg" disabled>
                            <i class="fas fa-credit-card me-2"></i>Xác nhận thanh toán
                        </button>
                    </form>
                </div>
            </div>
        </div>

        

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Initialize Swiper
                            const swiper = new Swiper('.movie-swiper', {
                loop: true, // Lặp vô hạn
                loopedSlides: 4, // Số lượng slide được nhân bản để hỗ trợ loop mượt hơn
                slidesPerView: 1,
                spaceBetween: 10,
                autoplay: {
                    delay: 3000,
                    disableOnInteraction: false,
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                breakpoints: {
                    480: {
                        slidesPerView: 1,
                    },
                    768: {
                        slidesPerView: 2,
                        spaceBetween: 20,
                    },
                    1024: {
                        slidesPerView: 4,
                        spaceBetween: 30,
                    }
                }
            });

                // Dark mode toggle
                document.getElementById("toggleDarkMode").addEventListener("click", function() {
                    document.body.classList.toggle("dark-mode");
                    const icon = this.querySelector('i');
                    if (document.body.classList.contains("dark-mode")) {
                        this.classList.remove("btn-dark");
                        this.classList.add("btn-light");
                        icon.classList.remove("fa-moon");
                        icon.classList.add("fa-sun");
                    } else {
                        this.classList.remove("btn-light");
                        this.classList.add("btn-dark");
                        icon.classList.remove("fa-sun");
                        icon.classList.add("fa-moon");
                    }
                });

                // Seat selection logic
                const seats = document.querySelectorAll('.seat:not(.occupied)');
                const selectedSeatsElement = document.getElementById('selectedSeats');
                const ticketCountElement = document.getElementById('ticketCount');
                const totalPriceElement = document.getElementById('totalPrice');
                const hiddenSeatsInput = document.getElementById('hiddenSeats');
                const hiddenAmountInput = document.getElementById('hiddenAmount');
                const checkoutBtn = document.getElementById('checkout');
                const bookingProgressBar = document.getElementById('bookingProgress');

                let selectedSeats = [];
                const ticketPrice = 50000;

                seats.forEach(seat => {
                    seat.addEventListener('click', function() {
                        this.classList.toggle('selected');
                        const seatNumber = this.getAttribute('data-seat');

                        if (this.classList.contains('selected')) {
                            selectedSeats.push(seatNumber);
                        } else {
                            const index = selectedSeats.indexOf(seatNumber);
                            if (index > -1) {
                                selectedSeats.splice(index, 1);
                            }
                        }

                        updateSelectedSeats();
                        updateBookingProgress();
                    });
                });

                // Movie selection logic
                const movieButtons = document.querySelectorAll('.select-movie');
                const selectedMovieElement = document.getElementById('selectedMovie');

                movieButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const movieName = this.getAttribute('data-movie-name');
                        selectedMovieElement.textContent = movieName;

                        document.getElementById('seat-selection').scrollIntoView({
                            behavior: 'smooth'
                        });

                        updateBookingProgress();
                    });
                });

                // Time selection logic
                const timeButtons = document.querySelectorAll('.time-btn');
                const selectedTimeElement = document.getElementById('selectedTime');

                timeButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        timeButtons.forEach(btn => btn.classList.remove('active'));
                        this.classList.add('active');

                        const time = this.getAttribute('data-time');
                        selectedTimeElement.textContent = time;

                        updateBookingProgress();
                    });
                });

                function updateSelectedSeats() {
                    selectedSeatsElement.textContent = selectedSeats.length ? selectedSeats.join(', ') : 'Chưa chọn';
                    ticketCountElement.textContent = selectedSeats.length;
                    totalPriceElement.textContent = formatCurrency(selectedSeats.length * ticketPrice);

                    hiddenSeatsInput.value = selectedSeats.join(',');
                    hiddenAmountInput.value = selectedSeats.length * ticketPrice;

                    checkoutBtn.disabled = selectedSeats.length === 0 ||
                                          selectedMovieElement.textContent === 'Chưa chọn' ||
                                          selectedTimeElement.textContent === 'Chưa chọn';
                }

                function updateBookingProgress() {
                    let progress = 0;
                    if (selectedMovieElement.textContent !== 'Chưa chọn') progress += 33;
                    if (selectedTimeElement.textContent !== 'Chưa chọn') progress += 33;
                    if (selectedSeats.length > 0) progress += 34;

                    bookingProgressBar.style.width = progress + '%';
                    bookingProgressBar.textContent = progress + '%';
                    bookingProgressBar.setAttribute('aria-valuenow', progress);

                    if (progress < 33) {
                        bookingProgressBar.className = 'progress-bar bg-danger';
                    } else if (progress < 66) {
                        bookingProgressBar.className = 'progress-bar bg-warning';
                    } else {
                        bookingProgressBar.className = 'progress-bar bg-success';
                    }
                }

                function formatCurrency(amount) {
                    return new Intl.NumberFormat('vi-VN').format(amount) + ' VNĐ';
                }
            });
        </script>

</body>
</html>